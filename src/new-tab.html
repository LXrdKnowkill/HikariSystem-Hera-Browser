<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova Aba - Hera Browser</title>
    <link rel="stylesheet" href="./new-tab.css"> 
</head>
<body>
    <div class="new-tab-container">
        
        <img src="./HeraBrowser.png" alt="Hera Browser Logo" class="new-tab-logo">

        <div class="new-tab-time" id="currentTime"></div>
        <div class="new-tab-search-wrapper">
            <input type="text" id="newTabSearchInput" placeholder="Pesquisar ou digitar URL">
            <button id="newTabSearchBtn" title="Pesquisar">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </svg>
</button>
        </div>
        <div class="new-tab-greeting">Bem-vindo ao Hera Browser!</div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const currentTimeElement = document.getElementById('currentTime');
            const newTabSearchInput = document.getElementById('newTabSearchInput');
            const newTabSearchBtn = document.getElementById('newTabSearchBtn');

            function updateTime() {
                const now = new Date();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                currentTimeElement.textContent = `${hours}:${minutes}`;
            }

            setInterval(updateTime, 1000);
            updateTime(); 

            const performSearch = async () => {
                const query = newTabSearchInput.value.trim();
                if (query) {
                    // Determina se é URL ou busca
                    const isUrl = /^(https?:\/\/)|(localhost)|([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}/.test(query);
                    let finalUrl = query;
                    
                    if (isUrl) {
                        if (!query.startsWith('http://') && !query.startsWith('https://')) {
                            finalUrl = `https://${query}`;
                        }
                    } else {
                        // Usa Google como mecanismo de busca padrão
                        finalUrl = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
                    }
                    
                    // Usa a API do Electron para navegar
                    if (window.heraAPI && window.heraAPI.navigateTo) {
                        await window.heraAPI.navigateTo(finalUrl);
                    }
                }
            };

            newTabSearchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
            newTabSearchBtn.addEventListener('click', performSearch);
        });
    </script>
</body>
</html>