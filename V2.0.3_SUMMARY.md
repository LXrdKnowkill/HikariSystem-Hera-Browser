# Hera Browser v2.0.3 - Resumo das MudanÃ§as

## ğŸ› CorreÃ§Ãµes CrÃ­ticas

### 1. Protocolo hera:// Funcionando
**Problema:** PÃ¡ginas internas (`hera://new-tab`, `hera://settings`, etc) mostravam erro do Windows "Obter um aplicativo para abrir este 'hera' link".

**Causa:** O cÃ³digo JavaScript usava `window.location.href` para navegar, fazendo o Windows interceptar o protocolo.

**SoluÃ§Ã£o:** MudanÃ§a para usar a API do Electron (`window.heraAPI.navigateTo()`).

**Arquivos Modificados:**
- `src/new-tab.html` - NavegaÃ§Ã£o agora usa API do Electron

### 2. WhatsApp Web com SessÃ£o Persistente
**Problema:** WhatsApp Web nÃ£o funcionava, pedindo para atualizar o Chrome e nÃ£o mantinha sessÃ£o.

**Causa:** Falta de configuraÃ§Ã£o de sessÃ£o persistente e User Agent inadequado.

**SoluÃ§Ã£o:** 
- Partition persistente para sites externos: `persist:web-content`
- User Agent configurado globalmente: Chrome 131
- PermissÃµes configuradas corretamente

**Arquivos Modificados:**
- `src/index.ts` - ConfiguraÃ§Ã£o de sessÃ£o e User Agent

## ğŸ”§ Melhorias TÃ©cnicas

### ConfiguraÃ§Ã£o de SessÃ£o
```typescript
// PÃ¡ginas internas (hera://) - sessÃ£o padrÃ£o
const partition = finalUrl.startsWith('hera://') ? undefined : 'persist:web-content';

// User Agent global
session.defaultSession.setUserAgent(userAgent);
const webSession = session.fromPartition('persist:web-content');
webSession.setUserAgent(userAgent);
```

### PermissÃµes Habilitadas
- media
- mediaKeySystem
- geolocation
- notifications
- midi
- midiSysex
- pointerLock
- fullscreen
- openExternal
- clipboard-read
- clipboard-sanitized-write

### Handler de Abertura de Janelas
```typescript
view.webContents.setWindowOpenHandler(({ url }) => {
  if (url.startsWith('hera://')) {
    createNewTab(url);
    return { action: 'deny' };
  }
  if (url.startsWith('http://') || url.startsWith('https://')) {
    createNewTab(url);
    return { action: 'deny' };
  }
  if (!url.startsWith('hera://')) {
    shell.openExternal(url).catch(err => {
      console.error('Erro ao abrir URL externa:', err);
    });
  }
  return { action: 'deny' };
});
```

## ğŸ“ Arquivos Modificados

### CÃ³digo Principal
- `src/index.ts` - ConfiguraÃ§Ã£o de sessÃ£o, User Agent e handlers
- `src/new-tab.html` - NavegaÃ§Ã£o usando API do Electron

### DocumentaÃ§Ã£o
- `CHANGELOG.md` - Adicionada versÃ£o 2.0.3
- `README.md` - Atualizada versÃ£o e changelog
- `package.json` - VersÃ£o atualizada para 2.0.3
- `docs/TECHNICAL_SOLUTIONS.md` - Nova documentaÃ§Ã£o tÃ©cnica consolidada

### Limpeza
- âŒ Removido `Yarinx.txt` (arquivo temporÃ¡rio)
- âŒ Removido `bookmarks-backup.json` (backup antigo)
- âœ… Criado `docs/TECHNICAL_SOLUTIONS.md` (documentaÃ§Ã£o consolidada)

## âœ… Testes Realizados

- [x] PÃ¡gina `hera://new-tab` carrega corretamente
- [x] WhatsApp Web funciona sem pedir atualizaÃ§Ã£o
- [x] WhatsApp Web mantÃ©m sessÃ£o apÃ³s reiniciar
- [x] NavegaÃ§Ã£o entre abas funciona
- [x] Favoritos funcionam
- [x] HistÃ³rico funciona
- [x] Downloads funcionam

## ğŸš€ PrÃ³ximos Passos

1. Testar em diferentes cenÃ¡rios
2. Verificar se hÃ¡ outros sites que precisam de ajustes
3. Considerar adicionar mais configuraÃ§Ãµes de sessÃ£o
4. Melhorar tratamento de erros

## ğŸ“¦ Como Atualizar

```bash
git pull origin main
npm install
npm run rebuild
npm start
```

## ğŸ™ CrÃ©ditos

Agradecimentos especiais Ã  **Yarinx** por identificar o problema da sessÃ£o persistente!

---

**VersÃ£o:** 2.0.3  
**Data:** 2025-11-03  
**Status:** âœ… Pronto para produÃ§Ã£o
